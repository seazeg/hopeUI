import { Story, Canvas, Meta } from "@storybook/addon-docs/blocks";
import { useEffect } from "@storybook/client-api";
import { viewinfo } from "../view/form.view.js";

# 表单（Form）

---

<Meta title="复用组件/表单(Form)" />

<Canvas>
    <Story
        name="表单(Form)"
        height="150px"
        parameters={{
            docs: {
                source: {
                    code: `${viewinfo.html}\n\n<script type="text/javascript">\n${viewinfo.js}\n</script>`,
                },
            },
        }}
    >
        {() => {
            useEffect(() => {
                setTimeout(() => {
                    Function(viewinfo.js)();
                }, 100);
            });
            return viewinfo.html;
        }}
    </Story>
</Canvas>

## 基础属性

| 参数 | 说明          | 类型   | 可选值               | 默认值  |
| ---- | ------------- | ------ | -------------------- | ------- |
| ele  | 元素 dom 节点 | String | Class / id / TagName | TagName |

## 表单控件 controls

| 参数          | 说明                                            | 类型   | 可选值 | 默认值 |
| ------------- | ----------------------------------------------- | ------ | ------ | ------ |
| [name]:Object | key 为表单内各控件 name,value 为一个配置 Object | Object | --     | --     |

| key     | value    | 说明                                            |
| ------- | -------- | ----------------------------------------------- |
| type    | Function | 控件类型 selector/radio/input/checkbox/textarea |
| options | Function | 控件配置                                        |
| on      | Function | 控件回调方法（具体参阅各控件）                  |
| verify  | Function | 自定义校验方法                                  |

## 回调方法 on

| 参数   | 说明       | 类型     | 默认值 | 回调参数     |
| ------ | ---------- | -------- | ------ | ------------ |
| init   | 初始化回调 | Function | null   | 当前对象 DOM |
| submit | 提交后回调 | Function | null   | event↓       |

| event 参数   | 说明               | 类型    |
| ------------ | ------------------ | ------- |
| objectParams | 表单元素键值对象   | Object  |
| stringParams | 反序列化参数字符串 | String  |
| jsonParams   | 序列化参数字符串   | Object  |
| status       | 是否通过校验状态   | Boolean |

## 调用方法

| 方法名            | 说明                 | 类型     | 默认值 | 参数                                                        |
| ----------------- | -------------------- | -------- | ------ | ----------------------------------------------------------- |
| val               | 外部赋值             | Function | --     | value,callback                                              |
| clear             | 外部清值             | Function | --     | callback                                                    |
| setGlobalRequired | 设置全局是否开启校验 | Function | --     | value(Boolean)                                              |
| verify            | 触发校验             | Function | --     | {ele:DOM-objects,value:控件值} |
| controls          | 所有控件声明后的对象 | Object   | --     | --                                                          |
